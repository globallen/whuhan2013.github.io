---
layout: post
title: 机器学习系统设计与建议
date: 2016-12-7
categories: blog
tags: [机器学习]
description: 机器学习系统设计与建议
---

当我们运用训练好了的模型来预测未知数据的时候发现有较大的误差,我们下一步可以 做什么?         
1. 获得更多的训练实例——通常是有效的,但代价较大,下面的方法也可能有效,可 考虑先采用下面的几种方法。     
2. 尝试减少特征的数量     
3. 尝试获得更多的特征    
4. 尝试增加多项式特征     
5. 尝试减少归一化程度 λ    
6. 尝试增加归一化程度 λ       

我们不应该随机选择上面的某种方法来改进我们的算法,而是运用一些机器学习诊断法
来帮助我们知道上面哪些方法对我们的算法是有效的。     

**评估一个假设**      
当我们确定学习算法的参数的时候,我们考虑的是选择参量来使训练误差最小化,有人 认为得到一个非常小的训练误差一定是一件好事,但我们已经知道,仅仅是因为这个假设具 有很小的训练误差,并不能说明它就一定是一个好的假设函数。而且我们也学习了过拟合假 设函数的例子,所以这推广到新的训练集上是不适用的。    

因此,我们需要另一种方法来评估我们的假设函数过拟合检验。          
为了检验算法是否过拟合,我们将数据分成训练集和测试集,通常用 70%的数据作为训 练集,用剩下 30%的数据作为测试集。很重要的一点是训练集和测试集均要含有各种类型的 数据,通常我们要对数据进行“洗牌”,然后再分成训练集和测试集。    

![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class6/p6.png)     

**模型选择和交叉验证集**       
假设我们要在 10 个不同次数的二项式模型之间进行选择:      
显然越高次数的多项式模型越能够适应我们的训练数据集,但是适应训练数据集并不代 表着能推广至一般情况,我们应该选择一个更能适应一般情况的模型。我们需要使用交叉验 证集来帮助选择模型。
即:使用 60%的数据作为训练集,使用 20%的数据作为交叉验证集,使用 20%的数据 作为测试集         

模型选择的方法为:     
1. 使用训练集训练出 10 个模型      
2. 用 10 个模型分别对交叉验证集计算得出交叉验证误差(代价函数的值)      
3. 选取代价函数值最小的模型        
4. 用步骤 3 中选出的模型对测试集计算得出推广误差(代价函数的值)        

**诊断偏差和方差**      
当你运行一个学习算法时,如果这个算法的表现不理想,那么多半是出现两种情况:要 么是偏差比较大,要么是方差比较大。换句话说,出现的情况要么是欠拟合,要么是过拟合 问题。那么这两种情况,哪个和偏差有关,哪个和方差有关,或者是不是和两个都有关?搞 清楚这一点非常重要,因为能判断出现的情况是这两种情况中的哪一种。其实是一个很有效 的指示器,指引着可以改进算法的最有效的方法和途径。

这个问题对于弄清如何改 进学习算法的效果非常重要,高偏差和高方差的问题基本上来说是欠拟合和过拟合的问题。

![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class6/p1.png) 

对于训练集,当 d 较小时,模型拟合程度更低,误差较大;随着 d 的增长,拟合程度  高,误差减小。       
对于交叉验证集,当 d 较小时,模型拟合程度低,误差较大;但是随着 d 的增长,误差呈现先减小后增大的趋势,转折点是我们的模型开始过拟合训练数据集的时候。     

如果我们的交叉验证集误差较大,我们如何判断是方差还是偏差呢? 根据上面的图表, 我们知道:      

训练集误差和交叉验证集误差近似时:偏差/欠拟合        
交叉验证集误差远大于训练集误差时:方差/过拟合      


**归一化和偏差/方差**       
在我们在训练模型的过程中,一般会使用一些归一化方法来防止过拟合。但是我们可能 会归一化的程度太高或太小了,即我们在选择 λ 的值时也需要思考与刚才选择多项式模型次 数类似的问题。     

我们选择一系列的想要测试的 λ 值,通常是 0-10 之间的呈现 2 倍关系的值(如: 0,0.01,0.02,0.04,0.08,0.15,0.32,0.64,1.28,2.56,5.12,10 共 12 个)。 我们同样把数据分为训练 集、交叉验证集和测试集。

选择 λ 的方法为:     
1. 使用训练集训练出 12 个不同程度归一化的模型      
2. 用 12 模型分别对交叉验证集计算的出交叉验证误差      
3. 选择得出交叉验证误差最小的模型       
4. 运用步骤 3 中选出模型对测试集计算得出推广误差,我们也可以同时将训练集和交叉验证集模型的代价函数误差与 λ 的值绘制在一张图表上:        

当 λ 较小时,训练集误差较小(过拟合)而交叉验证集误差较大        
随着 λ 的增加,训练集误差不断增加(欠拟合),而交叉验证集误差则是先减小后 增加     

